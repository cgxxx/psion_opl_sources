TRANSF:LOCAL A%(2),A$(50),A1$(60),C%,L%,M%,TYP%,T$(4),P$(2),D$(14),F$(14),NF$(14)UDG 1,0,0,0,0,0,0,0,31rem Activ PerifA%(1)=$3F17A%(2)=$3900USR(ADDR(A%()),0)DEB::CLSPRINT CHR$(5);REPT$(CHR$(1),15) :CLOCK(1)  view(2,"* ECHANGE PSION-MAC/PC * Daniel GUILLOUX - 06100 NICE *")AT 3,3PRINT "CHOIX ORDINATEUR"at 1,4M%=MENUN(2,"MAC,PC")IF M%=0 :STOPELSEIF M%=1 :A$=" MACINTOSH HD:¥ Utilitaires ¥:COMMS LINK:TRANSF:"ELSEIF M%=2 :A$="C:/PSION/"ENDIFclsPRINT CHR$(5);REPT$(CHR$(1),15) :CLOCK(1)  IF M%=1 : AT 5,2 :PRINT "Transfert MAC." ELSE AT 5,2 :PRINT "Transfert PC."ENDIFat 1,3 :PRINT "Path :"TRAP EDIT A$EM::clsPRINT CHR$(5);REPT$(CHR$(1),15) :CLOCK(1)  AT 1,3M%=MENUN(2,"EMISSION,RECEPTION")IF M%=0 : STOPELSEIF M%=1 : C%=1ELSEIF M%=2 : C%=2ENDIFD::CLSPRINT CHR$(5);REPT$(CHR$(1),15) :CLOCK(1)AT 6,2 :PRINT "CHOIX PACK"AT 1,4M%=MENUN(2,"A:,B:,C:")IF M%=0 : GOTO EM::ELSEIF M%=1 :P$="A:"ELSEIF M%=2 :P$="B:"ELSEIF M%=3 :P$="C:"ENDIFT::CLSAT 3,1 :PRINT "TYPE DE FICHIER"PRINT REPT$("-",20)M%=MENUN(2,"OPL,NOTES,FICHE,PLAN,COMMS,OPLOBJ,DIARY")IF M%=0 :GOTO D::ELSEIF M%=1 :T$=".OPL":TYP%=1ELSEIF M%=2 :T$=".NTS" :TYP%=7ELSEIF M%=3 :T$=".ODB" :TYP%=0ELSEIF M%=4 :T$=".PLN" :TYP%=5ELSEIF M%=5 :T$=".COM" :TYP%=4ELSEIF M%=6 :T$=".OPL" :TYP%=3ELSEIF M%=7 :T$=".DIA" :TYP%=2ENDIFONERR ERR::IF C%=2 : GOTO R:: : ENDIF CLSPRINT CHR$(169);REPT$(CHR$(1),15) :CLOCK(1)F$=P$+"*"+T$D$=DIRW$(F$)L%=LEN(D$)IF L%<1 :BEEP 50,200 :AT 5,2 :PRINT "INTROUVABLE" :PAUSE 40 : GOTO T:: :ENDIFAT 4,2 : PRINT D$NF$=LEFT$(D$,L%-4)L%=LEN(nf$)NF$=RIGHT$(NF$,L%-2)M%=GETA1$=A$+NF$if m%=6 AND TYP%=0 :goto ed::ELSEIF M%=3 :PRINT "   Transfert....." :XTSEND:(A1$,NF$,TYP%) :beep 10,500 :ENDIFWHILE D$<>""D$=DIRW$("")L%=LEN(D$)IF L%<1 :GOTO T:: :ENDIFcls : PRINT CHR$(169);REPT$(CHR$(1),15) :CLOCK(1)AT 4,2 :PRINT D$NF$=LEFT$(D$,L%-4)L%=LEN(nf$)NF$=RIGHT$(NF$,L%-2)A1$=A$+NF$M%=GETIF M%=1 :GOTO T::ELSEIF M%=3 :PRINT "   Transfert.....":XTSEND:(A1$,NF$,TYP%)beep 10,500elseif m%=6 AND TYP%=0 :goto ed::ELSE GOTO SUIT::ENDIFSUIT::A1$=""ENDWHT$=""GOTO T::R::cls : PRINT CHR$(170);REPT$(CHR$(1),15) :CLOCK(1)PRINT "Fichier : ";: input nf$if nf$="" :goto d:: : endifa1$=a$+nf$at 1,3 :PRINT "Nom Psion : "; :EDIT nf$nf$=p$+nf$PRINT "   Transfert....."xtrecv:(a1$,nf$,typ%)beep 10,500goto t::ED::A1$=A$+NF$+".ODB"BEEP 10,260clsat 3,1 :PRINT"Mise … Jour de :"AT 5,2:PRINT NF$+".ODB"XFOPEN:(A1$,4,1)XFPUT:(CHR$(13))OPEN NF$,A,B$,C$,D$,E$,F$,G$,H$DOXFPUT:(A.B$+CHR$(9)+A.C$+CHR$(9)+A.D$+CHR$(9)+A.E$+CHR$(9)+A.F$+CHR$(9)+A.G$+CHR$(9)+A.H$)NEXTUNTIL EOFCLOSEXFCLOSE:BEEP 10,500AT 3,3 :PRINT"Effacer ";NF$AT 7,4 : PRINT "(O/N)  ?"M:: M%=GETIF M%=%O :DELETE NF$ :GOTO t::ELSEIF M%=%N :GOTO t::ENDIFGOTO DEB::ERR::ONERR OFFcls : PRINT CHR$(5);REPT$(CHR$(1),15) :CLOCK(1)BEEP 50,200IF ERR=190 OR ERR=189 :AT 1,3 :PRINT "   FICHIER/ACCES         INCORRECT": PAUSE -40 :GOTO T::ELSEIF ERR=188 OR ERR=203 :AT 1,3 :PRINT "   ERREUR SERVEUR" :PAUSE -40 :GOTO DEB::ENDIF