TELEPH3:REM TARIF TELECOM 10/97LOCAL A$(8),D%,T%,H%,M%,S%,se%,SEC%,DEBUT$(8),ut,PT,HJ,DUR%,Z%,H$(50,6),M$(50,6),S$(50,6),I%,J%,PR,PRT,UT2,dg%menu::udg 0,31,21,14,10,31,31,0,31udg 2,0,0,0,0,0,0,0,31PT=0CLSprint chr$(0);rept$(chr$(2),14)clock(1)m%=menun(2,"COMMUNICATIONS,CONSULT-CALCUL,FIN")if m%=0 or m%=3 :returnelseif m%=1 :goto AP::elseif m%=2 :goto PR::endifAP::ESCAPE OFFIF NOT EXIST ("a:JOURNAL")CREATE "A:JOURNAL",B,DATE$,T$,NOTE$,PTELSEOPEN "A:JOURNAL",B,DATE$,T$,NOTE$,PTENDIFZO::AT 1,1 :PRINT "CALCUL COUT TELECOM"AT 1,2 :PRINT "TARIFS OCTOBRE 1997"AT 1,3 :PRINT REPT$("-",20)m%=menun(2,"LOCALE,EXTERIEURE")if m%=0 :returnelseif m%=1 :Z%=1 :dur%=180 :UT2=.232elseif m%=2 :Z%=2 :dur%=39:UT2=.945endifCLSPOKEB $007C,0B.T$="00:00:00"B.DATE$=DATIM$DEBUT$=RIGHT$(DATIM$,8)HJ=(HOUR*60)+MINUTED%=DOW(DAY,MONTH,YEAR)IF D%<6 :GOTO SEM::ELSEIF D%=6 :GOTO SAM::ELSEIF D%=7 :GOTO DIM::ENDIFSEM::UT2=.116IF HJ>480 AND HJ<1140 : UT2=UT2*2ENDIFIF Z%=2UT2=.4726IF HJ>480 AND HJ<1140 : UT2=UT2*2ENDIFENDIFGOTO SUIT::SAM::UT2=.116IF HJ>480 AND HJ<720 :UT2=UT2*2ENDIFIF Z%=2UT2=.4726IF HJ>480 AND HJ<720 :UT2=UT2*2ENDIFENDIFGOTO SUIT::DIM::UT2=.4726IF Z%=1uT2=.116ENDIFSUIT::H%=0 :M%=0 :S%=0 :SE%=0 :SEC%=SECONDUT=.615dg%=1DOIF SEC%<>SECONDBEEP 1,100if dg%=1 :pt=pt+ut :dg%=0 : endifSEC%=SECOND :S%=S%+1 :se%=se%+1IF S%=60 :S%=0 :M%=M%+1IF M%=60 :M%=0 :H%=H%+1ENDIFENDIFIF SE%=DUR% :SE%=0 :BEEP 50,200 :PT=PT+UT2 : UT=UT2 :DUR%=60 :endifB.T$=REPT$("0",-(H%<10))+NUM$(H%,2)+":"B.T$=B.T$+REPT$("0",-(M%<10))+NUM$(M%,2)+":"B.T$=B.T$+REPT$("0",-(S%<10))+NUM$(S%,2)ENDIFAT 3,1 :PRINT "Heure : ";DEBUT$AT 3,2 :PRINT "Duree : ";B.T$at 2,3 :print "Prix   :";FIX$(PT,3,-7);" HT"AT 3,4 :PRINT UT;" / ";DUR% ;" Sec."AT 19,4 :PRINT z%B.PT=PTPAUSE -1T%=KEYIF T%=1GOTO SORTIE::ENDIFUNTIL T%=13AT 1,4 :PRINT REPT$(" ",20); AT 1,4 :PRINT "NOTES ";chr$(63);TRAP INPUT B.NOTE$IF B.NOTE$="" :GOTO SORTIE:: :ENDIFIF ERR=206GOTO SORTIE::ENDIFCLS :AT 3,2 :PRINT "SAUVEGARDE..." :APPENDPAUSE 10SORTIE::POKEB $007C,1CLOSEESCAPE ONgoto MENU::PR::CLSH%=0 :M%=0 :S%=0 :PRT=0OPEN "A:JOURNAL",A,D$,T$,N$,PRFIRSTI%=1WHILE NOT EOFBEEP 50,100CLSDISP(-1,"")H$(I%)=LEFT$(A.T$,2)M$(I%)=MID$(A.T$,4,2)S$(I%)=RIGHT$(A.T$,2)PRT=PRT+a.PRI%=I%+1NEXTENDWHCLOSE CLSAT 1,2 :PRINT "Calculs en cours..."CREATE "A:H",B,H$,M$,S$J%=1WHILE  J%<I%B.H$=H$(J%)B.M$=M$(J%)B.S$=S$(J%)APPENDJ%=J%+1ENDWHCLOSEOPEN "A:H",C,H%,M%,S%WHILE NOT EOFS%=S%+C.S%IF S%>=60 :S%=S%-60 :M%=M%+1 :ENDIFM%=M%+C.M%IF M%>=60 :M%=M%-60 :H%=H%+1 :ENDIFH%=H%+C.H%NEXTENDWHCLOSECLSA$=REPT$("0",-(H%<10))+NUM$(H%,2)+":"A$=A$+REPT$("0",-(M%<10))+NUM$(M%,2)+":"A$=A$+REPT$("0",-(S%<10))+NUM$(S%,2)AT 4,1 :PRINT "DUREE TOTALE :"AT 7,2 :PRINT A$AT 5,3 :PRINT "COUT TOTAL :"AT 1,4 :PRINT FIX$(PRT,2,-6);" HT/";FIX$(PRT*1.206,2,-6);" TTC"BEEP 50,200DELETE "A:H"getgoto menu::