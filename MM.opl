MM:GLOBAL T$(16,16)GLOBAL A%(4),C%(4),D%(4),G%,I%,J%GLOBAL K%,M%,S%,T%,NUM%,RES1%,RES2%ONERR PRTERR::CLSVIEW(1,"MASTERMIND - 1990")G%=0S%=0T%=0NEWGAME::KSTAT 3I%=INT((RND+RND+RND)*3333)I%=I%-(I%/10000)*10000NUM%=I%D%(1)=I%/1000I%=I%-D%(1)*1000D%(2)=I%/100I%=I%-D%(2)*100D%(3)=I%/10D%(4)=I%-D%(3)*10M%=1CLST$(1)=" NB  ESSAI  B  M"AT 1,2PRINT T$(1);DOM%=M%+1I%=1J%=M%T$(M%)=" "+CHR$((M%-1)/10+48)+CHR$(M%-1-((M%-1)/10)*10+48)+"  "DOCLSPRINT T$(J%-1);PRINT T$(J%);IF J%<M%CURSOR OFFELSECURSOR ONENDIFK%=GETIF K%=3 AND J%>2J%=J%-1ELSEIF K%=4 AND J%<M%J%=J%+1ELSEIF K%>47 AND K%<58J%=M%A%(I%)=K%-48T$(M%)=T$(M%)+CHR$(K%)I%=I%+1ELSEIF K%=8 AND I%>1J%=M%I%=I%-1K%=LEN(T$(M%))T$(M%)=LEFT$(T$(M%),K%-1)ELSEIF K%=1CLSPRINT"   FIN DU JEU"BEEP 750,1500GOTO LABEL::ELSEBEEP 15,300ENDIFUNTIL I%>4C%(1)=D%(1)C%(2)=D%(2)C%(3)=D%(3)C%(4)=D%(4)I%=1RES1%=0RES2%=0DOIF A%(I%)=C%(I%)RES1%=RES1%+1A%(I%)=-1C%(I%)=-2ENDIFI%=I%+1UNTIL I%>4IF RES1%<4I%=1DOJ%=1DOIF A%(I%)=C%(J%)RES2%=RES2%+1A%(I%)=-1C%(J%)=-2ENDIFJ%=J%+1UNTIL J%>4I%=I%+1UNTIL I%>4ENDIFAT 1,2T$(M%)=T$(M%)+"   "+CHR$(RES1%+48)+"  "+CHR$(RES2%+48)PRINT T$(M%);PAUSE 10UNTIL RES1%=4 OR M%=16K%=KEYPAUSE 15CLST%=T%+1S%=S%+M%-1IF RES1%=4G%=G%+1PRINT M%-1,"ESSAI(S)"I%=2000DOBEEP 25,I%I%=I%-100UNTIL I%<100ELSECLSPRINT"JE GAGNE !!!"PRINT NUM%;BEEP 1000,2000ENDIFLABEL::KSTAT 1PRINT"ENCORE? (O/N)";IF GET=%O:GOTO NEWGAME::ENDIFCURSOR OFFIF T%>0CLSVIEW(1,"VOUS AVEZ JOUE "+GEN$(T%,3)+" FOIS ET GAGNE"+GEN$(G%,3)+" FOIS. SCORE FINAL"+FIX$(FLT(S%/T%),2,5)+".")CLSENDIFRETURNPRTERR::CLSPRINT ERR$(ERR)BEEP 1000,2000GOTO LABEL::