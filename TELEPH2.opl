TELEPH2:LOCAL A$(8),D%,T%,H%,M%,S%,se%,SEC%,DEBUT$(8),ut,PT,HJ,DUR%,Z%,H$(50,6),M$(50,6),S$(50,6),I%,J%,PR,PRTmenu::udg 0,31,21,14,10,31,31,0,31udg 2,0,0,0,0,0,0,0,31CLSprint chr$(0);rept$(chr$(2),14)clock(1)m%=menun(2,"COMMUNICATIONS,CONSULT-CALCUL,FIN")if m%=0 or m%=3 :returnelseif m%=1 :goto AP::elseif m%=2 :goto PR::endifAP::ESCAPE OFFIF NOT EXIST ("a:JOURNAL")CREATE "A:JOURNAL",B,DATE$,T$,NOTE$,PTELSEOPEN "A:JOURNAL",B,DATE$,T$,NOTE$,PTENDIFZO::AT 1,1 :PRINT "CALCUL COUT TELECOM"AT 1,2 :PRINT REPT$("-",20)AT 2,3 :PRINT "ZONE (1,2,3,4,5)";CHR$(63); :INPUT Z% IF Z%=0 :return ELSEIF Z%>5 :goto ZO::ENDIFCLSPOKEB $007C,0B.T$="00:00:00"B.DATE$=DATIM$DEBUT$=RIGHT$(DATIM$,8)HJ=(HOUR*60)+MINUTED%=DOW(DAY,MONTH,YEAR)IF D%<6 :GOTO SEM::ELSEIF D%=6 :GOTO SAM::ELSEIF D%=7 :GOTO DIM::ENDIFSEM::IF HJ>=360 AND HJ<480 :DUR%=360ELSEIF HJ>=480 AND HJ<750 :DUR%=180ELSEIF HJ>=750 AND HJ<810 :DUR%=252ELSEIF HJ>=810 AND HJ<1080 :DUR%=180ELSEIF HJ>=1080 AND HJ<1290 :DUR%=252ELSEIF HJ>=1290 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<=360 :DUR%=504ENDIFGOTO SUIT::SAM::IF HJ>=360 AND HJ<480 :DUR%=360ELSEIF HJ>=480 AND HJ<750 :DUR%=180ELSEIF HJ>=750 AND HJ<810 :DUR%=252ELSEIF HJ>=810 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<360 :DUR%=504ENDIFGOTO SUIT::DIM::IF HJ>=360 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<360 :DUR%=504ENDIFSUIT::H%=0 :M%=0 :S%=0 :SE%=0 :SEC%=SECONDPT=0.615 : UT=0.615IF Z%=3 :DUR%=DUR%*.25ELSEIF Z%=4 AND DUR%=180 :DUR%=24ELSEIF Z%=4 AND DUR%=252 :DUR%=34ELSEIF Z%=4 AND DUR%=360 :DUR%=48ELSEIF Z%=4 AND DUR%=504 :DUR%=67ELSEIF Z%=5 AND DUR%=180 :DUR%=19ELSEIF Z%=5 AND DUR%=252 :DUR%=27ELSEIF Z%=5 AND DUR%=360 :DUR%=38ELSEIF Z%=5 AND DUR%=504 :DUR%=53ENDIFDOIF SEC%<>SECONDBEEP 1,100SEC%=SECOND :S%=S%+1 :se%=se%+1IF S%=60 :S%=0 :M%=M%+1IF M%=60 :M%=0 :H%=H%+1ENDIFENDIFIF SE%=DUR% :SE%=0 :BEEP 50,200 :PT=PT+UTENDIFREM CHGT TRANCHE AUTOHJ=(HOUR*60)+MINUTED%=DOW(DAY,MONTH,YEAR)IF D%<6 :GOTO SEMA::ELSEIF D%=6 :GOTO SAME::ELSEIF D%=7 :GOTO DIMA::ENDIFSEMA::IF HJ>=360 AND HJ<480 :DUR%=360ELSEIF HJ>=480 AND HJ<750 :DUR%=180ELSEIF HJ>=750 AND HJ<810 :DUR%=252ELSEIF HJ>=810 AND HJ<1080 :DUR%=180ELSEIF HJ>=1080 AND HJ<1290 :DUR%=252ELSEIF HJ>=1290 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<=360 :DUR%=504ENDIFGOTO SUITE::SAME::IF HJ>=360 AND HJ<480 :DUR%=360ELSEIF HJ>=480 AND HJ<750 :DUR%=180ELSEIF HJ>=750 AND HJ<810 :DUR%=252ELSEIF HJ>=810 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<360 :DUR%=504ENDIFGOTO SUITE::DIMA::IF HJ>=360 AND HJ<1350 :DUR%=360ELSEIF HJ>=1350 OR HJ<360 :DUR%=504ENDIFSUITE::IF Z%=3 :DUR%=DUR%*.25ELSEIF Z%=4 AND DUR%=180 :DUR%=24ELSEIF Z%=4 AND DUR%=252 :DUR%=34ELSEIF Z%=4 AND DUR%=360 :DUR%=48ELSEIF Z%=4 AND DUR%=504 :DUR%=67ELSEIF Z%=5 AND DUR%=180 :DUR%=19ELSEIF Z%=5 AND DUR%=252 :DUR%=27ELSEIF Z%=5 AND DUR%=360 :DUR%=38ELSEIF Z%=5 AND DUR%=504 :DUR%=53ENDIFB.T$=REPT$("0",-(H%<10))+NUM$(H%,2)+":"B.T$=B.T$+REPT$("0",-(M%<10))+NUM$(M%,2)+":"B.T$=B.T$+REPT$("0",-(S%<10))+NUM$(S%,2)ENDIFAT 3,1 :PRINT "Heure : ";DEBUT$AT 3,2 :PRINT "Duree : ";B.T$at 2,3 :print "Prix   :";FIX$(PT,3,-7);" HT"AT 3,4 :PRINT "1 UT / ";DUR% ;" Sec."AT 20,4 :PRINT Z%B.PT=PTPAUSE -1T%=KEYIF T%=1GOTO SORTIE::ENDIFUNTIL T%=13AT 1,4 :PRINT REPT$(" ",20); AT 1,4 :PRINT "NOTES ";chr$(63);TRAP INPUT B.NOTE$IF B.NOTE$="" :GOTO SORTIE:: :ENDIFIF ERR=206GOTO SORTIE::ENDIFCLS :AT 3,2 :PRINT "SAUVEGARDE..." :APPENDPAUSE 10SORTIE::POKEB $007C,1CLOSEESCAPE ONgoto MENU::PR::CLSH%=0 :M%=0 :S%=0 :PRT=0OPEN "A:JOURNAL",A,D$,T$,N$,PRFIRSTI%=1WHILE NOT EOFBEEP 50,100CLSDISP(-1,"")H$(I%)=LEFT$(A.T$,2)M$(I%)=MID$(A.T$,4,2)S$(I%)=RIGHT$(A.T$,2)PRT=PRT+a.PRI%=I%+1NEXTENDWHCLOSE CLSAT 1,2 :PRINT "Calculs en cours..."CREATE "A:H",B,H$,M$,S$J%=1WHILE  J%<I%B.H$=H$(J%)B.M$=M$(J%)B.S$=S$(J%)APPENDJ%=J%+1ENDWHCLOSEOPEN "A:H",C,H%,M%,S%WHILE NOT EOFS%=S%+C.S%IF S%>=60 :S%=S%-60 :M%=M%+1 :ENDIFM%=M%+C.M%IF M%>=60 :M%=M%-60 :H%=H%+1 :ENDIFH%=H%+C.H%NEXTENDWHCLOSECLSA$=REPT$("0",-(H%<10))+NUM$(H%,2)+":"A$=A$+REPT$("0",-(M%<10))+NUM$(M%,2)+":"A$=A$+REPT$("0",-(S%<10))+NUM$(S%,2)AT 4,1 :PRINT "DUREE TOTALE :"AT 7,2 :PRINT A$AT 5,3 :PRINT "COUT TOTAL :"AT 1,4 :PRINT FIX$(PRT,2,-6);" HT/";FIX$(PRT*1.206,2,-6);" TTC"BEEP 50,200DELETE "A:H"getgoto menu::